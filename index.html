
<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>でじたるわーく</title>
		    <meta http-equiv="Cache-Control" content="no-store">
    <link rel="stylesheet" href="css/mainstyle.css">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
		    <script src="javascript/mainscript.js"></script>
		    <link rel="icon" href="icon.png">
<link rel="apple-touch-icon" href="icon.png" sizes="180x180">
		 <link rel="manifest" href="manifest.json">
		 <script>
    const CACHE_NAME = 'pwa-sample-caches-v1';
    // Cache targets
    const urlsToCache = ['/'];

    self.addEventListener('install', (event) => {
      event.waitUntil(
        caches
          .open(CACHE_NAME)
          .then((cache) => {
            return cache.addAll(urlsToCache);
          })
      );
    });

    self.addEventListener('fetch', (event) => {
      event.respondWith(
        caches
          .match(event.request)
          .then((response) => {
            return response ? response : fetch(event.request);
          })
      );
    });
			 
  </script>
		        <script src="https://coco-factory.jp/ugokuweb/wp-content/themes/ugokuweb/data/4-1-4/js/4-1-4.js"></script>
    <script>
        

//logoの表示
$(window).on('load',function(){
    $("#splash").delay(1500).fadeOut('slow');//ローディング画面を1.5秒（1500ms）待機してからフェードアウト
    $("#splash_logo").delay(1200).fadeOut('slow');//ロゴを1.2秒（1200ms）待機してからフェードアウト
});
</script>  
</head>
<body>
		      <div class="loading">
    <img class="loading__logo" src="icon.png">
</div>
      <header>
        <div class="header-content">
            <h1 id="quiz-subject" class="title">&nbsp;でじたるわーく</h1>&nbsp;    
            <p class="update-date">&nbsp;Ver1.0 Preview Beta4</p>
        </div>
    </header>
        <main>
    <div id="home-container" class="screen">
			<dl class="ac">
    <dt class="ac-parent" style="background-color:#f97148 !important;color:#fff !important;">歴史</dt>
				<dd class="ac-child"><ui style="background-color:#6e6e6e">
				<li><button onclick="selectSubject('人類の出現と文明の起こり')" class="btn_menu">人類の出現と文明の起こり</button></li>
				<li> <button onclick="selectSubject('人類の出現と文明の起こり2')" class="btn_menu">人類の出現と文明の起こり2</button></li>
				<li><button onclick="selectSubject('縄文弥生')" class="btn_menu">縄文時代~弥生時代</button></li>
				<li><button onclick="selectSubject('古墳飛鳥')" class="btn_menu">古墳時代~飛鳥時代</button></li>
				<li> <button onclick="selectSubject('奈良')" class="btn_menu">奈良時代</button></li>
				<li>  <button onclick="selectSubject('平安')" class="btn_menu">平安時代</button></li>
				<li> <button onclick="selectSubject('鎌倉')" class="btn_menu">鎌倉時代</button></li></ui></dd>
    <dt class="ac-parent" style="background-color:#04B404 !important;color:#fff !important;">地理</dt>
    <dd class="ac-child">追加予定</dd>
    <dt class="ac-parent" style="background-color:#8904B1 !important;color:#fff !important;">理科</dt>
    <dd class="ac-child">追加予定</dd>
    <dt class="ac-parent" style="background-color:#FE2E2E !important;color:#fff !important;">国語</dt>
    <dd class="ac-child">追加予定</dd>
				<dt class="ac-parent" style="background-color:#DF7401 !important;color:#fff !important;">数学</dt>
    <dd class="ac-child">追加予定</dd>
				<dt class="ac-parent" style="background-color:#DF01D7 !important;color:#fff !important;">English</dt>
    <dd class="ac-child">More to come</dd>
								<dt class="ac-parent" style="background-color:#333 !important;color:#fff !important;">技術・家庭</dt>
    <dd class="ac-child">追加予定</dd>
				    <dt class="ac-parent" style="background-color:#f97148 !important;color:#fff !important;">その他</dt>
								<dd class="ac-child"><ui style="background-color:#6e6e6e">
<li><button id="installApp" class="btn_menu">Webアプリをインストール</button></li>
<li><button id="clearCache" class="btn_menu">このAppのキャッシュをクリア</button></li></ui></dd>
				<dt class="ac-parent">このソフトについて</dt>
    <dd class="ac-child">
				<br>
				<h4>でじたるわーく</h4><br>
				<a>Ver1.0 Preview Beta4</a><br><br>
				<a>UI修正・WebAppに対応しました。</a><br><br>
				<a href="https://forms.gle/FWNhhseGVFSePsxWA">不具合の報告↗︎</a><br><br>
				<a>©︎ Hayato</a><br>
				<a>©︎ Straight SNS Gloup</a><br>
				<br>
				</dd>
  </dl>

    </div>
    <div id="iphonePopup">
        <p>このWebアプリをホーム画面に追加するには、<br>
        Safariの共有アイコン <img src="share-icon.png" alt="共有アイコン" style="height: 20px;"> をタップして<br>
        「ホーム画面に追加」を選んでください。</p>
        <button id="closePopup">閉じる</button>
    </div>
    <div id="subject-container" class="screen" style="display:none;">
			<br>
        <h1 id="subject-title">選択した教科</h1>
        <div id="unit-buttons"></div>
    </div>

 <div id="quiz-container" class="screen" style="display:none;margin-top:5%;">
    <div id="question-container">
						<center>
        <h2 id="question">問題が正常に読み込まれませんでした。やり直してください。</h2>
        <div class="choices">
            <button class="choice" onclick="checkAnswer(0)">選択肢1</button>
            <button class="choice" onclick="checkAnswer(1)">選択肢2</button>
            <button class="choice" onclick="checkAnswer(2)">選択肢3</button>
            <button class="choice" onclick="checkAnswer(3)">選択肢4</button>
					
        </div>
				</center>
    </div>
			<div id="answerbg">
			<div id="answersection">
							<center>
			<img id="result-image" style="display:none; width: 100px; height: 100px;text-align:center;" />
<audio id="result-sound"></audio>
			</center>
    <div id="result-container"></div>
			<center><button id="next-btn" onclick="nextQuestion()">次へ＞</button></center>
				</div>
				</div>
    <button id="show-answer-btn" onclick="showAnswer()">答えを表示する</button>
			    <button id="show-result-btn" onclick="confirmShowResult()">レッスンを終了</button>
    <div id="progress-bar-container">
        <div id="progress-bar"></div>
        <div id="progress-info">残り <span id="remaining-questions">0</span> 問</div>
    </div>
</div>


    <div id="result-screen" class="screen" style="display:none;">
        <h1>結果</h1>
        <canvas id="score-chart" width="400" height="400"></canvas>
        <p id="score">正解率: 0%</p>
        <button id="retry-btn" onclick="retryIncorrect()">不正解のみやり直し</button>
        <button onclick="goBackToTop()">トップに戻る</button>
    </div>
		<script>
        let deferredPrompt;

        // iPhoneを判定する関数
        function isIphone() {
            return /iPhone|iPad|iPod/i.test(navigator.userAgent);
        }

        // Androidを判定する関数
        function isAndroid() {
            return /Android/i.test(navigator.userAgent);
        }

        // ポップアップを表示する関数
        function showIphonePopup() {
            const popup = document.getElementById('iphonePopup');
            popup.style.display = 'block';
        }

        // インストールプロンプト表示用
        window.addEventListener('beforeinstallprompt', (e) => {
            e.preventDefault();  // 自動プロンプトを抑制
            deferredPrompt = e;
        });

        // ボタン押下時の処理
        document.getElementById('installApp').addEventListener('click', () => {
            if (isIphone()) {
                // iPhoneの場合、ポップアップを表示
                showIphonePopup();
            } else if (isAndroid() && deferredPrompt) {
                // Androidの場合、インストールプロンプトを表示
                deferredPrompt.prompt();
                deferredPrompt.userChoice.then((choiceResult) => {
                    if (choiceResult.outcome === 'accepted') {
                        console.log('ユーザーがPWAをインストールしました');
                    } else {
                        console.log('ユーザーがインストールをキャンセルしました');
                    }
                    deferredPrompt = null;
                });
            } else {
                alert('このデバイスではインストールできません');
            }
        });

        // ポップアップを閉じるボタン
        document.getElementById('closePopup').addEventListener('click', function() {
            document.getElementById('iphonePopup').style.display = 'none';
        });
			        document.getElementById('clearCache').addEventListener('click', () => {
            if ('caches' in window) {
                caches.keys().then(cacheNames => {
                    cacheNames.forEach(cacheName => {
                        caches.delete(cacheName);
                    });
                }).then(() => {
                    alert('キャッシュクリアに成功したため、リロードします。');
                    location.reload(); // キャッシュをクリア後にページをリロード
                });
            } else {
                alert('キャッシュAPIがサポートされていません。');
            }
        });
			</script>
		<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
		<script>
			$(function () {
  $('.ac-parent').on('click', function () {
    $(this).next().slideToggle();
    //openクラスをつける
    $(this).toggleClass("open");
    //クリックされていないac-parentのopenクラスを取る
    $('.ac-parent').not(this).removeClass('open');

    // 一つ開くと他は閉じるように
    $('.ac-parent').not($(this)).next('.ac-child').slideUp();
  });
});
			</script>


        </main>

</body>
</html>
